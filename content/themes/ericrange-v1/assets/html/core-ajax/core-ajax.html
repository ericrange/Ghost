<link rel="import" href="core-xhr.html"><polymer-element name="core-ajax" hidden attributes="url handleAs auto params response error method headers body contentType withCredentials"><script>Polymer("core-ajax",{url:"",handleAs:"",auto:!1,params:"",response:null,error:null,method:"",headers:null,body:null,contentType:"application/x-www-form-urlencoded",withCredentials:!1,xhrArgs:null,ready:function(){this.xhr=document.createElement("core-xhr")},receive:function(e,s){this.isSuccess(s)?this.processResponse(s):this.processError(s),this.complete(s)},isSuccess:function(e){var s=e.status||0;return!s||s>=200&&300>s},processResponse:function(e){var s=this.evalResponse(e);e===this.activeRequest&&(this.response=s),this.fire("core-response",{response:s,xhr:e})},processError:function(e){var s=e.status+": "+e.responseText;e===this.activeRequest&&(this.error=s),this.fire("core-error",{response:s,xhr:e})},complete:function(e){this.fire("core-complete",{response:e.status,xhr:e})},evalResponse:function(e){return this[(this.handleAs||"text")+"Handler"](e)},xmlHandler:function(e){return e.responseXML},textHandler:function(e){return e.responseText},jsonHandler:function(e){var s=e.responseText;try{return JSON.parse(s)}catch(r){return console.warn("core-ajax caught an exception trying to parse response as JSON:"),console.warn("url:",this.url),console.warn(r),s}},documentHandler:function(e){return e.response},blobHandler:function(e){return e.response},arraybufferHandler:function(e){return e.response},urlChanged:function(){if(!this.handleAs){var e=String(this.url).split(".").pop();switch(e){case"json":this.handleAs="json"}}this.autoGo()},paramsChanged:function(){this.autoGo()},autoChanged:function(){this.autoGo()},autoGo:function(){this.auto&&(this.goJob=this.job(this.goJob,this.go,0))},go:function(){var e=this.xhrArgs||{};e.body=this.body||e.body,e.params=this.params||e.params,e.params&&"string"==typeof e.params&&(e.params=JSON.parse(e.params)),e.headers=this.headers||e.headers||{},e.headers&&"string"==typeof e.headers&&(e.headers=JSON.parse(e.headers));var s=Object.keys(e.headers).some(function(e){return"content-type"===e.toLowerCase()});return!s&&this.contentType&&(e.headers["Content-Type"]=this.contentType),("arraybuffer"===this.handleAs||"blob"===this.handleAs||"document"===this.handleAs)&&(e.responseType=this.handleAs),e.withCredentials=this.withCredentials,e.callback=this.receive.bind(this),e.url=this.url,e.method=this.method,this.response=this.error=null,this.activeRequest=e.url&&this.xhr.request(e),this.activeRequest}});</script></polymer-element>